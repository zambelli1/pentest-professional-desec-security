# Dominando o terminal do Linux

## Introdução ao terminal

Aqui iremos ver alguns comandos básicos do terminal:

```bash
pwd #Mostra a localização do diretório atual
ls #Mostra todos os diretórios e arquivos no diretório atual
ls -l #Mostra uma listagem mais detalhada
ls -la #Mostra arquivos ocultos
cd #Muda de diretório (ex: cd Desktop/)
cd .. #Volta diretório
clear #Limpa a o bash
mkdir #Cria um diretório
touch #Criar um arquivo (ex: touch teste)
echo #Printa mensagem na tela
echo Mensagem > arquivo #Escreve a mensagem dentro de um arquivo
echo Mensagem2 >> arquivo #Escreve mensagem no final do arquivo sem sobrescrever
cat #Visualizar o conteúdo de um arquivo
tac #Exibe o arquivo com ordem invertida (tac = cat ao contrário)
rm #Remove arquivo
rm -rf #Remove um diretório com arquivos dentro (ex: rm -rf pasta/)
cp #Copia um arquivo (ex: cp arquivo arquivoCopia)
mv #Move um arquivo (ex: mv arquivoCopia ../)
head #Mostra apenas o começo do arquivo, bom para arquivos grandes
head -n1 #Mostra apenas a primeira linha, -n2 as duas primeiras...
tail #Mostra as ultimas linhas do arquivo
tail -n1 #Mostra apenas as 2 ultimas linhas, -n2 as duas ultimas...
tail -f #Consegue ver em tempo real as alterações, muito utilizado para monitorar logs
```

## Gerenciando Usuários

Se você estiver com usuário root, no terminal ficara com '**#**', caso for um usuário comum, ficará '**$**'.

Exemplo:
- root@pentest:~/Desktop#      (usuário root)
- pedro@pentest~/Desktop$    (usuário comum)

Para adicionarmos um usuário, podemos utilizar o comando:

```bash
adduser pedro
```

Logo após isso, irá pedir a senha, nome completo e outras informações.

Para saber se o usuário foi criado com sucesso, podemos acessar o arquivo que contém todos os usuários do sistema `etc/passwd`:

```bash
cat etc/passwd
```

Se quisermos deletar um usuário, podemos utilizar o comando:

```bash
deluser pedro
```

Outra maneira de criar um usuário de forma mais controlada podemos usar:

```bash
useradd -d /opt/desec -s /bin/bash desec 
#Onde -d é o diretório, -s a shell e desec o nome do usuário
```

Porém com esse comando, não é pedido a senha, para definir a senha, utilizamos o comando:

```bash
passwd desec
```

Para trocar de usuário, podemos utilizar:

```bash
su desec
```

Para dar permissão para esse usuário, precisamos adicionar esse usuário ao grupo **sudo** (OBS: precisa estar em conta root para adicionar o usuário no grupo sudo):

```bash
adduser desec sudo
```

Para revogar uma conta administrativa podemos utilizar:

```bash
deluser desec sudo
```

Podemos adicionar um usuário também abrindo o arquivo `/etc/sudoers` e colocando o usuário na lista e suas permissões:

```bash
nano /etc/sudoers
```

![](images/Pasted%20image%2020240103213507.png)

Para vermos os logs do sistema (tudo o que foi feito no sistema fica registrado) podemos acessar o `/var/log/auth.log`

```bash
cat /var/log/auth.log
```

## Gerenciando a Rede

Aqui vamos aprender como gerenciar a rede, e aprender alguns comandos:

```bash
ifconfig #Mostra as configurações dos adaptadores de rede
```

![](images/Pasted%20image%2020240103214308.png)

Para alterar o endereço IP para outra rede, podemos definir com:

```bash
ifconfig eth0 10.1.1.23 netmask 255.255.255.0
```

Agora se olharmos novamente, veremos que o endereço e mascara de rede terão mudado:

![](images/Pasted%20image%2020240103214612.png)

Mas essa configuração não fica salva, se reiniciarmos o computador iremos perder essa configuração, mas tem um arquivo de configuração que podemos definir essa configuração que será aplicada para quando a máquina for ligada, a configuração já vir pronta.

Para isso iremos abrir o `/etc/network/interfaces`

```bash
nano /etc/network/interfaces
```

E adicionar a configuração desejada:

![](images/Pasted%20image%2020240103215019.png)

Se quisermos mudar o IP e a mascara de rede, podemos alterar para

```
iface eth0 inet static
address 192.168.0.200
netmask 255.255.255.0
gateway 192.168.0.1
```

Para reiniciar o adaptador de rede, podemos utilizar um dos seguintes comandos:

```bash
service networking restart
```

```bash
/etc/init.d/networking restart
```

Para visualizar o Gateway, podemos utilizar o comando:

```bash
route
```

![](images/Pasted%20image%2020240103215640.png)

E para visualizar o IP dele, podemos utilizar:

```bash
route -n
```

![](images/Pasted%20image%2020240103215739.png)

Essa é a nossa rota que faz a gente se conectar com a internet. Por exemplo se utilizarmos o comando `ping` para tentar ver se um site responde, podemos ver:

![](images/Pasted%20image%2020240103215955.png)

Agora se deletarmos essa rota utilizando:

```bash
route del default
```

Se olharmos agora, nossa rota foi excluida:

![](images/Pasted%20image%2020240103220131.png)

E se tentarmos usar o `ping` para algum site, não vamos conseguir:

![](images/Pasted%20image%2020240103220226.png)

Para adicionar a rota novamente, podemos utilizar o comando:

```bash
route add default gw 192.168.0.1
```

Por fim, iremos conhecer o comando `netstat`, usado para visualizar conexões de rede:

```bash
netstat -lt # l = listen, t = tcp
netstat -lu # l = listen, u = udp
```

Se tiver algum serviço rodando, será exibido:

![](images/Pasted%20image%2020240103220545.png)

Se quisermos ver o número dessa porta, podemos adicionar o '**n**' em nossa pesquisa:

```bash
netstat -lnt
```

![](images/Pasted%20image%2020240103220735.png)

E para visualizarmos o nome do programa, podemos adicionar o '**p**' em nossa pesquisa:

![](images/Pasted%20image%2020240103220917.png)

